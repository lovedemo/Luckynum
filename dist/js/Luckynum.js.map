{"version":3,"sources":["../../js/Luckynum.js"],"names":["Luckynum","config","_img","img","_myDom","dom","_width","width","_height","height","_backgroundImg","backgroudImg","_btn","btn","_imgWidth","split","_topArr","_luckNum","_speed","_flag","_timer","_check","_checkAgain","_run","_top","addHtml","getTopArr","radomStart","_startHook","startHook","_endHook","endHook","start","document","getElementById","addEventListener","startRun","i","style","top","Math","floor","random","url","length","num","map","x","isRightNum","alert","clearTimeout","div","createElement","setAttribute","innerHTML","appendChild","content","getElementsByClassName","backgroundImage","imgString","mask","left","myimg","m","reSet","console","log","runUp","setTimeout","index","runfun","run","filter","b","undefined","isNow","abs"],"mappings":"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","file":"Luckynum.js","sourcesContent":["/**\r\n// * @file Luckynum\r\n * @author admin\r\n * @date 2017/11/21\r\n */\r\nexport class Luckynum{\r\n\r\n    constructor(config){\r\n\r\n        this._img=config.img;\r\n        this._myDom=config.dom;\r\n        this._width=config.width;\r\n        this._height=config.height;\r\n        this._backgroundImg=config.backgroudImg;\r\n        this._btn=config.btn;\r\n        this._imgWidth=config.img.width.split('px')[0];\r\n\r\n        this._topArr=[];// img对应的top值\r\n        this._luckNum=[];  //抽奖结果\r\n        this._speed=[]; //各个图片转动的速度\r\n        this._flag=[]; // 每个图片是否已停止\r\n        this._timer=null; //超时计时器\r\n\r\n        // 为实现慢慢停下来的效果 两次到达后才停下来\r\n        this._check=[];\r\n        this._checkAgain=[];\r\n\r\n        this._run=false;// 数字转动后，让开始按钮不可触发\r\n        this._top=[];// 当前图片所处位置\r\n        this.addHtml();\r\n        this.getTopArr();\r\n        this.radomStart();\r\n\r\n        this._startHook=config.startHook||this.startHook;\r\n        this._endHook=config.endHook||this.endHook;\r\n\r\n        //console.log(this._topArr)\r\n        //为按钮添加点击事件\r\n        let start = document.getElementById('luckynum-start');\r\n        start.addEventListener('click', () => {\r\n            this.startRun();\r\n        });\r\n    }\r\n    /*\r\n    * 获得一个随机的初始值\r\n    *\r\n    * */\r\n    radomStart() {\r\n        for(let i=0;i<3;i++){\r\n            document.getElementById('luckynum-img'+(i+1)).style.top=this._topArr[Math.floor(Math.random()*this._img.url.length)]+'px';\r\n            //console.log(document.getElementById('img'+(i+1)).style.top);\r\n        }\r\n    }\r\n\r\n    /*\r\n    * 设置获奖数字，可从服务端获取\r\n    *\r\n    **/\r\n    setNum(num) {\r\n        this._luckNum=(num+'').split('');\r\n        this._luckNum=this._luckNum.map(x=>{\r\n            return x-1;\r\n        })\r\n        let isRightNum=true;\r\n        this._luckNum.map(x=>{\r\n            if(x>=this._img.url.length)\r\n                isRightNum=false;\r\n        })\r\n        if(!isRightNum){\r\n            alert('错误的抽奖结果');\r\n            this._checkAgain=[true,true,true];\r\n            this._run=false;\r\n            clearTimeout(this._timer);\r\n            this._endHook('错误的抽奖结果');\r\n        }\r\n        //console.log(this._luckNum);\r\n    }\r\n\r\n    /*\r\n    * 初始化dom\r\n    *\r\n    * */\r\n    addHtml(){\r\n\r\n        let div = document.createElement('div');\r\n        div.setAttribute('id','luckynum');\r\n        div.style.width=this._width;\r\n        div.style.height=this._height;\r\n        div.innerHTML=`<div class=\"luckynum-content\">\r\n                            <div class=\"luckynum-mask \" id=\"luckynum-mask1\"><div class='luckynum-imgs' id='luckynum-img1'></div></div>\r\n                            <div class=\"luckynum-mask \" id=\"luckynum-mask2\"><div class='luckynum-imgs' id='luckynum-img2'></div></div>\r\n                            <div class=\"luckynum-mask \" id=\"luckynum-mask3\"><div class='luckynum-imgs' id='luckynum-img3'></div></div>\r\n                            <div class=\"luckynum-btn\" id=\"luckynum-start\"></div>\r\n                         </div>`;\r\n        this._myDom.appendChild(div);\r\n\r\n        let content=document.getElementsByClassName('luckynum-content')[0];\r\n        content.style.backgroundImage=\"url(\"+this._backgroundImg+\")\";\r\n        //console.log(content.style.backgroundImage)\r\n        let imgString='';\r\n        for (let i = 0; i < this._img.url.length; i++) {\r\n            imgString += '<img class=\"luckynum-myimg\" src=\"'+this._img.url[i]+'\" />';\r\n\r\n        }\r\n        for (let i=1;i<=3;i++){\r\n            let img=document.getElementById('luckynum-img'+i);\r\n            let mask=document.getElementById('luckynum-mask'+i);\r\n            //img.style.height=mask.clientWidth.toString().split('px')[0]+'px';\r\n            //mask.style.left=10+25*(i-1)+'%';\r\n            mask.style.left=this._img.left[i-1];\r\n            mask.style.top=this._img.top;\r\n            mask.style.height=this._imgWidth*1.5+'px';\r\n            mask.style.width=this._imgWidth+'px';\r\n           // console.log( mask.style.height)\r\n            img.innerHTML=imgString+imgString;\r\n        }\r\n       let myimg=document.getElementsByClassName('luckynum-myimg');\r\n        for(let m of myimg){\r\n            m.style.height=this._imgWidth+'px';\r\n           // console.log(m.style.height)\r\n        }\r\n\r\n        //生成btn\r\n        let btn=document.getElementById('luckynum-start');\r\n        btn.style.backgroundImage='url('+this._btn.url+')';\r\n        btn.style.width=this._btn.width;\r\n        btn.style.height=this._btn.height;\r\n        btn.style.top=this._btn.top;\r\n        btn.style.left=this._btn.left;\r\n        this.radomStart();\r\n    }\r\n\r\n    /**\r\n     *  计算结束的位置\r\n     *\r\n     **/\r\n    getTopArr(){\r\n\r\n       for(let i=1;i<this._img.url.length;i++){\r\n            // this._topArr[i]=-86+(-126*(i-1));\r\n           // 120 280\r\n            this._topArr[i]=-this._imgWidth*(i-0.25);\r\n       }\r\n       this._topArr[0]=this._topArr[this._img.url.length-1]-this._imgWidth;\r\n       this._topArr[this._img.url.length]=this._topArr[this._img.url.length-1]-this._imgWidth*2;\r\n\r\n    }\r\n    /**\r\n    * 开始转动\r\n    *\r\n    **/\r\n    startRun(){\r\n        if(!this._run) {\r\n            this.reSet();\r\n            console.log('start run')\r\n            this._startHook();\r\n            this._run=true;\r\n            this.runUp(0);\r\n            this.runUp(1);\r\n            this.runUp(2);\r\n            this._timer= setTimeout(()=>{\r\n                    if(this._luckNum.length===0)\r\n                    {\r\n                        this._checkAgain=[true,true,true];\r\n                        alert('抽奖超时');\r\n                        this._run=false;\r\n                        clearTimeout(this._timer);\r\n                        this._endHook('抽奖超时');\r\n                       // this.radomStart();\r\n                       // this.reSet();\r\n\r\n                    }\r\n            },10000)\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n    /*\r\n    * 根据传入的index转动对应的img\r\n    *\r\n    * */\r\n    runUp(index) {\r\n        let img=document.getElementById('luckynum-img'+(index+1));\r\n        this._top[index]= img.style.top.split('px')[0];\r\n        this._speed[index] =10;\r\n        this.runfun(img,index)\r\n\r\n    }\r\n\r\n    /*\r\n    * 控制循环的函数，当3个img都停下来就重置\r\n    * 用setimeout代替setInterval\r\n    *\r\n    * */\r\n    runfun(img,index) {\r\n        this.run(img,index);\r\n        if(!this._checkAgain[index]){\r\n            setTimeout(()=>{\r\n                this.runfun(img,index)\r\n            },10);\r\n        }else {\r\n            if(this._flag.filter(\r\n                    (b)=>{\r\n                        return b;\r\n                    }\r\n                ).length===3)\r\n            {\r\n                //console.log(this._luckNum);\r\n                console.log('reSet');\r\n                clearTimeout(this._timer);\r\n                this._endHook(this._luckNum.map(x=>{return ++x}));\r\n                this.reSet();\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n    * 循环函数，每次转动的速度为speed[index]\r\n    *\r\n    * */\r\n    run(img,index){\r\n        /*if(this._speed[index]===undefined)\r\n        {\r\n            console.log(this);\r\n            return;\r\n        }*/\r\n       // console.log(index);\r\n        if(this._luckNum[index]!==undefined&&this.isNow(index))\r\n        {\r\n            this._flag[index]=true;\r\n            this._checkAgain[index]=true;\r\n        }\r\n\r\n        if(this._top[index]<=this._topArr[this._img.url.length]){\r\n           // debugger\r\n            this._top[index]=-this._imgWidth*0.75;\r\n        }\r\n        img.style.top = this._top[index] + 'px';\r\n        this._top[index] -= this._speed[index];\r\n        //console.log(this._luckNum[index],img.style.top)\r\n    }\r\n\r\n    /*\r\n    * 判断当前是否应该停下\r\n    * return true/false\r\n    * */\r\n    isNow(index) {\r\n        let num=this._luckNum[index];\r\n\r\n        //前一个停下后速度才变为4，到达一次后速度变为2\r\n        switch (index){\r\n            case 2: if(this._flag[1]) {\r\n                         this._speed[index]=4;\r\n                        if(this._check[index])\r\n                            this._speed[index]=2;\r\n                    }\r\n                    break;\r\n            case 1: if(this._flag[0]) {\r\n                          this._speed[index]=4;\r\n                          if(this._check[index])\r\n                             this._speed[index]=2;\r\n                    }\r\n                    break;\r\n            case 0: this._speed[index]=4;\r\n                    if(this._check[index])\r\n                        this._speed[index]=2;\r\n        }\r\n\r\n        //到达对应的位置\r\n        if(Math.abs(this._top[index]-this._topArr[num])<5)\r\n        {\r\n            //如果第二次到达就停下来，否则就标记一次到达\r\n            if(this._check[index])\r\n            {\r\n               // console.log(this._speed[index])\r\n                return true;\r\n            }\r\n            else\r\n            {\r\n                if(this._speed[index]===4){\r\n                    this._check[index]=true;\r\n                    this._speed[index]=2;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /*\r\n    * 重置所有参数\r\n    *\r\n     * */\r\n    reSet() {\r\n        this._luckNum=[];\r\n        this._speed=[];\r\n        this._flag=[];\r\n        this._check=[];\r\n        this._run=false;\r\n        this._checkAgain=[]\r\n\r\n    }\r\n\r\n    startHook(){\r\n        console.log('默认startHook')\r\n        return 0;\r\n    }\r\n    endHook(){\r\n        console.log('默认endHook')\r\n        return 0;\r\n    }\r\n}\r\n\r\n\r\n"]}